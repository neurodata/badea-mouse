

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Comparisons of differences in brain regions &#8212; Mouse Connectomes</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '2023-03-01-volume-differences';</script>
    <link rel="shortcut icon" href="_static/nd_logo_small.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Investigation of Distances of Brain Volume and FA" href="2023-05-10-combined.html" />
    <link rel="prev" title="K-sample latent position distribution test" href="2023-01-10-nonpar.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="coverpage.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/nd_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/nd_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="coverpage.html">
                    Mouse Brain and Alzheimerâ€™s Disease
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Brain Volume Covariances</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="2022-01-28-volume-analysis.html">Brain Volume Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="2022-03-15-multimodal-clustering.html">Test whether brain volume and FA are independent</a></li>



<li class="toctree-l1"><a class="reference internal" href="2022-08-20-label-cmp.html">Comparing Subgroups of Edges</a></li>
<li class="toctree-l1"><a class="reference internal" href="2022-11-17-volume-correlation-analysis-ranked.html">Exploratory analysis on volume correlations</a></li>
<li class="toctree-l1"><a class="reference internal" href="2022-11-18-multigraph-clustering.html">Hierarchical Clustering Analysis - Omnibus Embedding</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-01-10-nonpar.html">K-sample latent position distribution test</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Comparisons of differences in brain regions</a></li>


<li class="toctree-l1"><a class="reference internal" href="2023-05-10-combined.html">Investigation of Distances of Brain Volume and FA</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/neurodata/badea-mouse" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/neurodata/badea-mouse/issues/new?title=Issue%20on%20page%20%2F2023-03-01-volume-differences.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/2023-03-01-volume-differences.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Comparisons of differences in brain regions</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Comparisons of differences in brain regions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-average-differences-between-regions">Visualize the average differences between regions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-abolute-differences-in-genotypes">Visualize the abolute differences in genotypes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#edge-wise-analysis-of-distances">Edge-wise analysis of distances</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-wise-analysis-of-distances">Vertex-wise analysis of distances</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparisons-of-differences-in-fractional-anisotropy">Comparisons of differences in fractional anisotropy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Visualize the average differences between regions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Visualize the abolute differences in genotypes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Edge-wise analysis of distances</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Vertex-wise analysis of distances</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-the-results-from-volume-distances-and-fa-distances">Comparing the results from volume distances and FA distances</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#edge-wise-analysis-of-results">Edge-wise analysis of results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-wise-analysis-of-results">Vertex wise analysis of results</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="comparisons-of-differences-in-brain-regions">
<h1>Comparisons of differences in brain regions<a class="headerlink" href="#comparisons-of-differences-in-brain-regions" title="Permalink to this heading">#</a></h1>
<p>In this work, we examine if the differences in brain regions of mice are related to genotype. That is, are some of the differences in brain regions different in APOE2, APOE3, and APOE4 genotypes? This approach contrasts to the brain volume covariance approach, but allows for graph based approaches to studying brain volumes by treating the distance matrix as a graph. For example, if two regions have positive correlation in a particular genotype, then the correlation of the differences in brain regions should also have positive correlation. Therefore, this approach allows for similar, if not the same, interpretation of the brain volume correlation methods.</p>
<p>In this notebook, we will first normalize the brain volumes such that we are studying the relative brain volumes. We will then compute the differences in brain regions for all pairs of regions for each subject, resulting in a distance matrix per subject. We will then test if the differences between a specific pairs are different among the genotypes, that is compute a p-value for each pair of regions. We will then test if all the pairwise differences in brain volume corresponding to particular regions are different among the genotypes.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">graspologic</span> <span class="k">as</span> <span class="nn">gp</span>
<span class="kn">import</span> <span class="nn">hyppo</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">hyppo.ksample</span> <span class="kn">import</span> <span class="n">MANOVA</span><span class="p">,</span> <span class="n">KSample</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span><span class="p">,</span> <span class="n">squareform</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.multitest</span> <span class="kn">import</span> <span class="n">multipletests</span>

<span class="kn">from</span> <span class="nn">pkg.data</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">GENOTYPES</span><span class="p">,</span>
    <span class="n">HEMISPHERES</span><span class="p">,</span>
    <span class="n">SUB_STRUCTURES</span><span class="p">,</span>
    <span class="n">SUPER_STRUCTURES</span><span class="p">,</span>
    <span class="n">load_fa</span><span class="p">,</span>
    <span class="n">load_fa_corr</span><span class="p">,</span>
    <span class="n">load_vertex_df</span><span class="p">,</span>
    <span class="n">load_vertex_metadata</span><span class="p">,</span>
    <span class="n">load_volume</span><span class="p">,</span>
    <span class="n">load_volume_corr</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vertex_df</span> <span class="o">=</span> <span class="n">load_vertex_df</span><span class="p">()</span>
<span class="n">vols</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">load_volume</span><span class="p">()</span>

<span class="c1"># normalize volumes</span>
<span class="n">vols</span> <span class="o">/=</span> <span class="n">vols</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">unique_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

<span class="c1"># make distance matrices</span>
<span class="n">vol_dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">squareform</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vols</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="visualize-the-average-differences-between-regions">
<h2>Visualize the average differences between regions<a class="headerlink" href="#visualize-the-average-differences-between-regions" title="Permalink to this heading">#</a></h2>
<p>We first visualize the mean distance matrix separated by genotypes. We do not observe specific patterns among the genotypes, but we see that very few select regions have significantly high differences in brain regions.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">means</span> <span class="o">=</span> <span class="p">[</span><span class="n">vol_dists</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)]</span>

<span class="c1">## plot the mean differences per genotype</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">vol_dists</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">gp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">adjplot</span><span class="p">(</span>
        <span class="n">means</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="c1"># meta=vertex_name,</span>
        <span class="c1"># group=[&quot;Hemisphere_abbrev&quot;],</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/f99e5df34a70e3ec14c42097a3560933d39f28c5d04ac63f519caf420a659fe3.png" src="_images/f99e5df34a70e3ec14c42097a3560933d39f28c5d04ac63f519caf420a659fe3.png" />
</div>
</div>
</section>
<section id="visualize-the-abolute-differences-in-genotypes">
<h2>Visualize the abolute differences in genotypes<a class="headerlink" href="#visualize-the-abolute-differences-in-genotypes" title="Permalink to this heading">#</a></h2>
<p>Here take the absolute differences in the mean distance matrices, and visualize the resulting matrix. We now see that different pairs of genotypes show distinct patterns.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## plot the absolute difference in means</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">label1</span><span class="p">,</span> <span class="n">label2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="n">label1</span><span class="p">]</span> <span class="o">-</span> <span class="n">means</span><span class="p">[</span><span class="n">label2</span><span class="p">])</span>
    <span class="n">gp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">adjplot</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="c1"># meta=vertex_name,</span>
        <span class="c1"># group=[&quot;Hemisphere_abbrev&quot;],</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">unique_labels</span><span class="p">[</span><span class="n">label1</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">unique_labels</span><span class="p">[</span><span class="n">label2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/1614c943f586ad7c4316d21ecf0cc6e24e2805f58012f776b2eae65d80dacca7.png" src="_images/1614c943f586ad7c4316d21ecf0cc6e24e2805f58012f776b2eae65d80dacca7.png" />
</div>
</div>
</section>
<section id="edge-wise-analysis-of-distances">
<h2>Edge-wise analysis of distances<a class="headerlink" href="#edge-wise-analysis-of-distances" title="Permalink to this heading">#</a></h2>
<p>Here, we examine if the distances of a particular pairs of the brain are different among the genoptyes. Let <span class="math notranslate nohighlight">\(D^{(k)}_{ij}\)</span> denote a <span class="math notranslate nohighlight">\(332 \times 332\)</span> distance matrix for a particular subject with genotype <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(i,j\)</span> indexing a particular element in the distance matrix. Here, we will test if the distributions of the differences between each pair of brain regions are significantly different via distance correlations. That is for each <span class="math notranslate nohighlight">\(i,j\)</span> pair of brain regions we test:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
H_0:&amp; F_{D^{(APOE2)}_{ij}} = F_{D^{(APOE3)}_{ij}} = F_{D^{(APOE4)}_{ij}}\\
H_A:&amp; \exists F_{D^{(k)}_{ij}} \neq F_{D^{(l)}_{ij}}
\end{align*}\]</div>
<p>where the null is that there is no differences in the distribution of  distances of brain regions, while the altnate is that there exists at least one pair of genotype is different.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rdx</span><span class="p">,</span> <span class="n">cdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">vol_dists</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">rdx</span><span class="o">.</span><span class="n">size</span>

<span class="n">apoe2</span> <span class="o">=</span> <span class="n">vol_dists</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="s2">&quot;APOE22&quot;</span><span class="p">]</span>
<span class="n">apoe3</span> <span class="o">=</span> <span class="n">vol_dists</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="s2">&quot;APOE33&quot;</span><span class="p">]</span>
<span class="n">apoe4</span> <span class="o">=</span> <span class="n">vol_dists</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="s2">&quot;APOE44&quot;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">worker</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">stat</span><span class="p">,</span> <span class="n">pval</span> <span class="o">=</span> <span class="n">KSample</span><span class="p">(</span><span class="s2">&quot;Dcorr&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="n">reps</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">stat</span><span class="p">,</span> <span class="n">pval</span>


<span class="n">res</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span>
    <span class="n">delayed</span><span class="p">(</span><span class="n">worker</span><span class="p">)(</span><span class="n">apoe2</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">apoe3</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">apoe4</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rdx</span><span class="p">,</span> <span class="n">cdx</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;stat&quot;</span><span class="p">,</span> <span class="s2">&quot;pvalue&quot;</span><span class="p">])</span>

<span class="n">edge_df</span><span class="p">[</span><span class="s2">&quot;rdx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rdx</span>
<span class="n">edge_df</span><span class="p">[</span><span class="s2">&quot;cdx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cdx</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">edge_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">loc1</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;rdx&quot;</span><span class="p">]</span>
    <span class="n">region1</span> <span class="o">=</span> <span class="n">vertex_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">loc1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Hemisphere&quot;</span><span class="p">,</span> <span class="s2">&quot;Structure&quot;</span><span class="p">]]</span>

    <span class="n">loc2</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;cdx&quot;</span><span class="p">]</span>
    <span class="n">region2</span> <span class="o">=</span> <span class="n">vertex_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">loc2</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Hemisphere&quot;</span><span class="p">,</span> <span class="s2">&quot;Structure&quot;</span><span class="p">]]</span>

    <span class="n">edge_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;region1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">region1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">edge_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;region2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">region2</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">significant</span><span class="p">,</span> <span class="n">corrected_pvalue</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">multipletests</span><span class="p">(</span><span class="n">edge_df</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fdr_bh&quot;</span><span class="p">)</span>

<span class="n">edge_df</span><span class="p">[</span><span class="s2">&quot;corrected_pvalue&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">corrected_pvalue</span>
<span class="n">edge_df</span><span class="p">[</span><span class="s2">&quot;significant&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">significant</span>

<span class="n">edge_df</span> <span class="o">=</span> <span class="n">edge_df</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;stat&quot;</span><span class="p">,</span> <span class="s2">&quot;pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;corrected_pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;significant&quot;</span><span class="p">,</span> <span class="s2">&quot;region1&quot;</span><span class="p">,</span> <span class="s2">&quot;region2&quot;</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">edge_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../outs/volume_edge.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Here we list out the top 10 pairs of regions that are significantly different with the largest test statistic.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;stat&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stat</th>
      <th>pvalue</th>
      <th>corrected_pvalue</th>
      <th>significant</th>
      <th>region1</th>
      <th>region2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>33434</th>
      <td>0.501310</td>
      <td>0.0001</td>
      <td>0.021213</td>
      <td>True</td>
      <td>L-Lateral_Olfactory_Tract</td>
      <td>L-Medial_Lemniscus</td>
    </tr>
    <tr>
      <th>33418</th>
      <td>0.452451</td>
      <td>0.0001</td>
      <td>0.021213</td>
      <td>True</td>
      <td>L-Lateral_Olfactory_Tract</td>
      <td>L-Ventral_Hippocampal_Commissure</td>
    </tr>
    <tr>
      <th>50236</th>
      <td>0.429288</td>
      <td>0.0001</td>
      <td>0.021213</td>
      <td>True</td>
      <td>R-Periaquaductal_Grey</td>
      <td>R-Pontine_Reticular_Nucleus</td>
    </tr>
    <tr>
      <th>18976</th>
      <td>0.411637</td>
      <td>0.0001</td>
      <td>0.021213</td>
      <td>True</td>
      <td>L-Striatum</td>
      <td>L-Spinocerebellar_Tract</td>
    </tr>
    <tr>
      <th>19148</th>
      <td>0.408775</td>
      <td>0.0001</td>
      <td>0.021213</td>
      <td>True</td>
      <td>L-Striatum</td>
      <td>R-Cerebellar_White_Matter</td>
    </tr>
    <tr>
      <th>33600</th>
      <td>0.400340</td>
      <td>0.0001</td>
      <td>0.021213</td>
      <td>True</td>
      <td>L-Lateral_Olfactory_Tract</td>
      <td>R-Medial_Lemniscus</td>
    </tr>
    <tr>
      <th>33584</th>
      <td>0.396358</td>
      <td>0.0001</td>
      <td>0.021213</td>
      <td>True</td>
      <td>L-Lateral_Olfactory_Tract</td>
      <td>R-Ventral_Hippocampal_Commissure</td>
    </tr>
    <tr>
      <th>15679</th>
      <td>0.396218</td>
      <td>0.0001</td>
      <td>0.021213</td>
      <td>True</td>
      <td>L-Dorsal_Tenia_Tecta</td>
      <td>L-Ventral_Hippocampal_Commissure</td>
    </tr>
    <tr>
      <th>33711</th>
      <td>0.391122</td>
      <td>0.0001</td>
      <td>0.021213</td>
      <td>True</td>
      <td>L-Ventral_Hippocampal_Commissure</td>
      <td>R-Claustrum</td>
    </tr>
    <tr>
      <th>15845</th>
      <td>0.388886</td>
      <td>0.0001</td>
      <td>0.021213</td>
      <td>True</td>
      <td>L-Dorsal_Tenia_Tecta</td>
      <td>R-Ventral_Hippocampal_Commissure</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The total number of significant pairs of regions are 713 out of 54946 pairs.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_df</span><span class="o">.</span><span class="n">significant</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>713
</pre></div>
</div>
</div>
</div>
</section>
<section id="vertex-wise-analysis-of-distances">
<h2>Vertex-wise analysis of distances<a class="headerlink" href="#vertex-wise-analysis-of-distances" title="Permalink to this heading">#</a></h2>
<p>Here we examine if the distances of brain volumes are different on a region basis. That is, we test if all the pairwise differences in brain volumes corresponding to a particular regions are significantly different. Let <span class="math notranslate nohighlight">\(D^{(k)}_{i}\)</span> denote a <span class="math notranslate nohighlight">\(332 \times 332\)</span> distance matrix for a particular subject with genotype <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(i\)</span> indexing a particular <strong>row</strong> of the distance matrix. Here, we will test if the distributions of the distances corresponding to a particular brain region are significantly different via distance correlations. That is for each <span class="math notranslate nohighlight">\(i\)</span>  brain region we test:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
H_0:&amp; F_{D^{(APOE2)}_{i}} = F_{D^{(APOE3)}_{i}} = F_{D^{(APOE4)}_{i}}\\
H_A:&amp; \exists F_{D^{(k)}_{i}} \neq F_{D^{(l)}_{i}}
\end{align*}\]</div>
<p>where the null is that there is no differences in the distribution of distances, while the altnate is that there exists at least one pair of genotype is different.</p>
<p>This approach contrasts from the prior approach in Edge-wise analysis in that for each comparison, we are using all of the information given by a particular region of the brain. This allows for more reliable results because it allows for interation between all of the regions in a single comparison.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span>
    <span class="n">delayed</span><span class="p">(</span><span class="n">worker</span><span class="p">)(</span><span class="n">apoe2</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">apoe3</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">apoe4</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">apoe2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="p">)</span>

<span class="n">region_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;stat&quot;</span><span class="p">,</span> <span class="s2">&quot;pvalue&quot;</span><span class="p">])</span>

<span class="n">region_df</span><span class="p">[</span><span class="s2">&quot;idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">apoe2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">region_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;idx&quot;</span><span class="p">]</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">vertex_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">loc</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Hemisphere&quot;</span><span class="p">,</span> <span class="s2">&quot;Structure&quot;</span><span class="p">]]</span>

    <span class="n">region_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">region_df</span> <span class="o">=</span> <span class="n">region_df</span><span class="p">[[</span><span class="s2">&quot;stat&quot;</span><span class="p">,</span> <span class="s2">&quot;pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;corrected_pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;significant&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">]]</span>

<span class="n">significant</span><span class="p">,</span> <span class="n">corrected_pvalue</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">multipletests</span><span class="p">(</span><span class="n">region_df</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fdr_bh&quot;</span><span class="p">)</span>

<span class="n">region_df</span><span class="p">[</span><span class="s2">&quot;corrected_pvalue&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">corrected_pvalue</span>
<span class="n">region_df</span><span class="p">[</span><span class="s2">&quot;significant&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">significant</span>

<span class="n">region_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../outs/volume_vertex.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Here we list out the top 10 regions that are significantly different with the largest test statistic.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;stat&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stat</th>
      <th>pvalue</th>
      <th>corrected_pvalue</th>
      <th>significant</th>
      <th>region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>63</th>
      <td>0.330623</td>
      <td>0.000249</td>
      <td>0.049952</td>
      <td>True</td>
      <td>L-Striatum</td>
    </tr>
    <tr>
      <th>256</th>
      <td>0.189688</td>
      <td>0.001658</td>
      <td>0.049952</td>
      <td>True</td>
      <td>R-Cerebellar_Cortex</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.177294</td>
      <td>0.001907</td>
      <td>0.049952</td>
      <td>True</td>
      <td>L-Primary_Motor_Cortex</td>
    </tr>
    <tr>
      <th>168</th>
      <td>0.138262</td>
      <td>0.002073</td>
      <td>0.049952</td>
      <td>True</td>
      <td>R-Cingulate_Cortex_Area_24b</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.145418</td>
      <td>0.002653</td>
      <td>0.049952</td>
      <td>True</td>
      <td>L-Cingulate_Cortex_Area_24b</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.139471</td>
      <td>0.002819</td>
      <td>0.049952</td>
      <td>True</td>
      <td>L-Primary_Somatosensory_Cortex_Jaw_Region</td>
    </tr>
    <tr>
      <th>197</th>
      <td>0.140740</td>
      <td>0.003068</td>
      <td>0.049952</td>
      <td>True</td>
      <td>R-Primary_Somatosensory_Cortex_Upper_Lip_Region</td>
    </tr>
    <tr>
      <th>209</th>
      <td>0.134273</td>
      <td>0.003565</td>
      <td>0.049952</td>
      <td>True</td>
      <td>R-Dorsolateral_Entorhinal_Cortex</td>
    </tr>
    <tr>
      <th>234</th>
      <td>0.131458</td>
      <td>0.003565</td>
      <td>0.049952</td>
      <td>True</td>
      <td>R-Periaquaductal_Grey</td>
    </tr>
    <tr>
      <th>246</th>
      <td>0.155338</td>
      <td>0.003980</td>
      <td>0.049952</td>
      <td>True</td>
      <td>R-Superior_Colliculus</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The total number of significant regions is 259 out of 332 regions.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">region_df</span><span class="o">.</span><span class="n">significant</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>259
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="comparisons-of-differences-in-fractional-anisotropy">
<h1>Comparisons of differences in fractional anisotropy<a class="headerlink" href="#comparisons-of-differences-in-fractional-anisotropy" title="Permalink to this heading">#</a></h1>
<p>In these sections, we test for fractional anisotropy instead of brain volumes</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vertex_df</span> <span class="o">=</span> <span class="n">load_vertex_df</span><span class="p">()</span>
<span class="n">fas</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">load_fa</span><span class="p">()</span>

<span class="c1"># normalize volumes</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fas</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">fas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">fas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">unique_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

<span class="c1"># make distance matrices</span>
<span class="n">fa_dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">squareform</span><span class="p">(</span><span class="n">pdist</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fas</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="id1">
<h2>Visualize the average differences between regions<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>We first visualize the mean distance matrix separated by genotypes. We do not observe specific patterns among the genotypes.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">means</span> <span class="o">=</span> <span class="p">[</span><span class="n">fa_dists</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)]</span>

<span class="c1">## plot the mean differences per genotype</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">fa_dists</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">gp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">adjplot</span><span class="p">(</span>
        <span class="n">means</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="c1"># meta=vertex_name,</span>
        <span class="c1"># group=[&quot;Hemisphere_abbrev&quot;],</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/6bbe0afb5d3d1834d629f6ad60cbc68d48a8779c93a5c1858b626b8bc36b606c.png" src="_images/6bbe0afb5d3d1834d629f6ad60cbc68d48a8779c93a5c1858b626b8bc36b606c.png" />
</div>
</div>
</section>
<section id="id2">
<h2>Visualize the abolute differences in genotypes<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>Here take the absolute differences in the mean distance matrices, and visualize the resulting matrix. We now see that different pairs of genotypes show distinct patterns.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## plot the absolute difference in means</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">label1</span><span class="p">,</span> <span class="n">label2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">means</span><span class="p">[</span><span class="n">label1</span><span class="p">]</span> <span class="o">-</span> <span class="n">means</span><span class="p">[</span><span class="n">label2</span><span class="p">])</span>
    <span class="n">gp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">adjplot</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="c1"># meta=vertex_name,</span>
        <span class="c1"># group=[&quot;Hemisphere_abbrev&quot;],</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">unique_labels</span><span class="p">[</span><span class="n">label1</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">unique_labels</span><span class="p">[</span><span class="n">label2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/d564e2d82ebb23efa528728491b50edc1786521839195e050e508c3ce8faf487.png" src="_images/d564e2d82ebb23efa528728491b50edc1786521839195e050e508c3ce8faf487.png" />
</div>
</div>
</section>
<section id="id3">
<h2>Edge-wise analysis of distances<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rdx</span><span class="p">,</span> <span class="n">cdx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">fa_dists</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">rdx</span><span class="o">.</span><span class="n">size</span>

<span class="n">apoe2</span> <span class="o">=</span> <span class="n">fa_dists</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="s2">&quot;APOE22&quot;</span><span class="p">]</span>
<span class="n">apoe3</span> <span class="o">=</span> <span class="n">fa_dists</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="s2">&quot;APOE33&quot;</span><span class="p">]</span>
<span class="n">apoe4</span> <span class="o">=</span> <span class="n">fa_dists</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="s2">&quot;APOE44&quot;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">worker</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">stat</span><span class="p">,</span> <span class="n">pval</span> <span class="o">=</span> <span class="n">KSample</span><span class="p">(</span><span class="s2">&quot;Dcorr&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="n">auto</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="n">reps</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">stat</span><span class="p">,</span> <span class="n">pval</span>


<span class="n">res</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span>
    <span class="n">delayed</span><span class="p">(</span><span class="n">worker</span><span class="p">)(</span><span class="n">apoe2</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">apoe3</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">apoe4</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rdx</span><span class="p">,</span> <span class="n">cdx</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;stat&quot;</span><span class="p">,</span> <span class="s2">&quot;pvalue&quot;</span><span class="p">])</span>

<span class="n">edge_df</span><span class="p">[</span><span class="s2">&quot;rdx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rdx</span>
<span class="n">edge_df</span><span class="p">[</span><span class="s2">&quot;cdx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cdx</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">edge_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">loc1</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;rdx&quot;</span><span class="p">]</span>
    <span class="n">region1</span> <span class="o">=</span> <span class="n">vertex_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">loc1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Hemisphere&quot;</span><span class="p">,</span> <span class="s2">&quot;Structure&quot;</span><span class="p">]]</span>

    <span class="n">loc2</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;cdx&quot;</span><span class="p">]</span>
    <span class="n">region2</span> <span class="o">=</span> <span class="n">vertex_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">loc2</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Hemisphere&quot;</span><span class="p">,</span> <span class="s2">&quot;Structure&quot;</span><span class="p">]]</span>

    <span class="n">edge_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;region1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">region1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">edge_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;region2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">region2</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">significant</span><span class="p">,</span> <span class="n">corrected_pvalue</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">multipletests</span><span class="p">(</span><span class="n">edge_df</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fdr_bh&quot;</span><span class="p">)</span>

<span class="n">edge_df</span><span class="p">[</span><span class="s2">&quot;corrected_pvalue&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">corrected_pvalue</span>
<span class="n">edge_df</span><span class="p">[</span><span class="s2">&quot;significant&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">significant</span>

<span class="n">edge_df</span> <span class="o">=</span> <span class="n">edge_df</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;stat&quot;</span><span class="p">,</span> <span class="s2">&quot;pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;corrected_pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;significant&quot;</span><span class="p">,</span> <span class="s2">&quot;region1&quot;</span><span class="p">,</span> <span class="s2">&quot;region2&quot;</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">edge_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../outs/fa_edge.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;stat&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stat</th>
      <th>pvalue</th>
      <th>corrected_pvalue</th>
      <th>significant</th>
      <th>region1</th>
      <th>region2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>53084</th>
      <td>0.512056</td>
      <td>0.00005</td>
      <td>0.032704</td>
      <td>True</td>
      <td>R-Raphe_Nucleus</td>
      <td>R-Spinal_Trigeminal_Nerve</td>
    </tr>
    <tr>
      <th>54456</th>
      <td>0.494586</td>
      <td>0.00005</td>
      <td>0.032704</td>
      <td>True</td>
      <td>R-Spinal_Trigeminal_Nerve</td>
      <td>R-Medial_Lemniscus</td>
    </tr>
    <tr>
      <th>43300</th>
      <td>0.472303</td>
      <td>0.00005</td>
      <td>0.032704</td>
      <td>True</td>
      <td>R-Dorsolateral_Orbital_Cortex</td>
      <td>R-Cingulate_Cortex_Area_25</td>
    </tr>
    <tr>
      <th>46672</th>
      <td>0.460022</td>
      <td>0.00005</td>
      <td>0.032704</td>
      <td>True</td>
      <td>R-Primary_Visual_Cortex_Monocular_Area</td>
      <td>R-Cingulate_Cortex_Area_25</td>
    </tr>
    <tr>
      <th>9175</th>
      <td>0.452144</td>
      <td>0.00005</td>
      <td>0.032704</td>
      <td>True</td>
      <td>L-Primary_Somatosensory_Cortex_Jaw_Region</td>
      <td>R-Cingulate_Cortex_Area_25</td>
    </tr>
    <tr>
      <th>1708</th>
      <td>0.450266</td>
      <td>0.00005</td>
      <td>0.032704</td>
      <td>True</td>
      <td>L-Cingulate_Cortex_Area_29b</td>
      <td>L-Anterior_Pretectal_Nucleus</td>
    </tr>
    <tr>
      <th>40575</th>
      <td>0.449442</td>
      <td>0.00005</td>
      <td>0.032704</td>
      <td>True</td>
      <td>L-IntermediateReticularNucleus</td>
      <td>R-Cerebrospinal_fluid</td>
    </tr>
    <tr>
      <th>23417</th>
      <td>0.442129</td>
      <td>0.00005</td>
      <td>0.032704</td>
      <td>True</td>
      <td>L-Superior_Colliculus</td>
      <td>R-Dorsolateral_Orbital_Cortex</td>
    </tr>
    <tr>
      <th>8586</th>
      <td>0.441193</td>
      <td>0.00005</td>
      <td>0.032704</td>
      <td>True</td>
      <td>L-Primary_Somatosensory_Cortex_Hindlimb_Region</td>
      <td>L-Primary_Somatosensory_Cortex_Jaw_Region</td>
    </tr>
    <tr>
      <th>38139</th>
      <td>0.436460</td>
      <td>0.00005</td>
      <td>0.032704</td>
      <td>True</td>
      <td>L-Cingulate_Cortex_Area_25</td>
      <td>R-Dorsolateral_Orbital_Cortex</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_df</span><span class="o">.</span><span class="n">significant</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>993
</pre></div>
</div>
</div>
</div>
<p>The total number of significant pairs of regions are 993 out of 54946 pairs.</p>
</section>
<section id="id4">
<h2>Vertex-wise analysis of distances<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span>
    <span class="n">delayed</span><span class="p">(</span><span class="n">worker</span><span class="p">)(</span><span class="n">apoe2</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">apoe3</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">apoe4</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">reps</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">apoe2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="p">)</span>

<span class="n">region_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;stat&quot;</span><span class="p">,</span> <span class="s2">&quot;pvalue&quot;</span><span class="p">])</span>

<span class="n">region_df</span><span class="p">[</span><span class="s2">&quot;idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">apoe2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">region_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;idx&quot;</span><span class="p">]</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">vertex_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">loc</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Hemisphere&quot;</span><span class="p">,</span> <span class="s2">&quot;Structure&quot;</span><span class="p">]]</span>

    <span class="n">region_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">significant</span><span class="p">,</span> <span class="n">corrected_pvalue</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">multipletests</span><span class="p">(</span><span class="n">region_df</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fdr_bh&quot;</span><span class="p">)</span>
<span class="n">region_df</span><span class="p">[</span><span class="s2">&quot;corrected_pvalue&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">corrected_pvalue</span>
<span class="n">region_df</span><span class="p">[</span><span class="s2">&quot;significant&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">significant</span>

<span class="n">region_df</span> <span class="o">=</span> <span class="n">region_df</span><span class="p">[[</span><span class="s2">&quot;stat&quot;</span><span class="p">,</span> <span class="s2">&quot;pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;corrected_pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;significant&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">]]</span>

<span class="n">region_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../outs/fa_vertex.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;pvalue&quot;</span><span class="p">,</span> <span class="s2">&quot;stat&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stat</th>
      <th>pvalue</th>
      <th>corrected_pvalue</th>
      <th>significant</th>
      <th>region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>0.268610</td>
      <td>0.00029</td>
      <td>0.026892</td>
      <td>True</td>
      <td>L-Primary_Somatosensory_Cortex_Jaw_Region</td>
    </tr>
    <tr>
      <th>314</th>
      <td>0.324524</td>
      <td>0.00032</td>
      <td>0.026892</td>
      <td>True</td>
      <td>R-Cingulate_Cortex_Area_25</td>
    </tr>
    <tr>
      <th>173</th>
      <td>0.285267</td>
      <td>0.00041</td>
      <td>0.026892</td>
      <td>True</td>
      <td>R-Cingulate_Cortex_Area_30</td>
    </tr>
    <tr>
      <th>72</th>
      <td>0.234462</td>
      <td>0.00047</td>
      <td>0.026892</td>
      <td>True</td>
      <td>L-Ventral_Thalamic_Nuclei</td>
    </tr>
    <tr>
      <th>157</th>
      <td>0.295831</td>
      <td>0.00059</td>
      <td>0.026892</td>
      <td>True</td>
      <td>L-Red_Nucleus_Magnocellular</td>
    </tr>
    <tr>
      <th>202</th>
      <td>0.255369</td>
      <td>0.00063</td>
      <td>0.026892</td>
      <td>True</td>
      <td>R-Primary_Visual_Cortex_Monocular_Area</td>
    </tr>
    <tr>
      <th>50</th>
      <td>0.228251</td>
      <td>0.00067</td>
      <td>0.026892</td>
      <td>True</td>
      <td>L-Hippocampus</td>
    </tr>
    <tr>
      <th>229</th>
      <td>0.243990</td>
      <td>0.00072</td>
      <td>0.026892</td>
      <td>True</td>
      <td>R-Striatum</td>
    </tr>
    <tr>
      <th>148</th>
      <td>0.283246</td>
      <td>0.00077</td>
      <td>0.026892</td>
      <td>True</td>
      <td>L-Cingulate_Cortex_Area_25</td>
    </tr>
    <tr>
      <th>270</th>
      <td>0.281154</td>
      <td>0.00081</td>
      <td>0.026892</td>
      <td>True</td>
      <td>R-Raphe_Nucleus</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">region_df</span><span class="o">.</span><span class="n">significant</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>59
</pre></div>
</div>
</div>
</div>
<p>The total number of significant regions is 59 out of 332 regions.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="comparing-the-results-from-volume-distances-and-fa-distances">
<h1>Comparing the results from volume distances and FA distances<a class="headerlink" href="#comparing-the-results-from-volume-distances-and-fa-distances" title="Permalink to this heading">#</a></h1>
<p>To compare the results of volume and FA edge-wise analysis, we compute two measures:</p>
<ol class="arabic simple">
<li><p>Kendallâ€™s Tau, which measures the correspondence between two rankings. Values close to 1 indicate strong agreement, and values close to -1 indicate strong disagreement. We compute Kendallâ€™s Tau of the rankings of the test statistics.</p></li>
<li><p>Jaccard distance, which measures the distance between two boolean vectors. We compute the distance between the vectors containing whether the test was significant or not.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">jaccard</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">kendalltau</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_regions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../outs/volume_vertex.csv&quot;</span><span class="p">)</span>
<span class="n">fa_regions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../outs/fa_vertex.csv&quot;</span><span class="p">)</span>

<span class="n">vol_edge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../outs/volume_edge.csv&quot;</span><span class="p">)</span>
<span class="n">fa_edge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../outs/fa_edge.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="edge-wise-analysis-of-results">
<h2>Edge-wise analysis of results<a class="headerlink" href="#edge-wise-analysis-of-results" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_edge_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">vol_edge</span><span class="o">.</span><span class="n">stat</span><span class="p">)</span>
<span class="n">fa_edge_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">fa_edge</span><span class="o">.</span><span class="n">stat</span><span class="p">)</span>

<span class="n">kendalltau</span><span class="p">(</span><span class="n">vol_edge_idx</span><span class="p">,</span> <span class="n">fa_edge_idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SignificanceResult(statistic=-0.0014717900860659208, pvalue=0.6048229796699123)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jaccard</span><span class="p">(</span><span class="n">fa_edge</span><span class="o">.</span><span class="n">significant</span><span class="p">,</span> <span class="n">vol_edge</span><span class="o">.</span><span class="n">significant</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9958799293702177
</pre></div>
</div>
</div>
</div>
<p>We get Kendallâ€™s Tau of -0.00147 and Jaccard distance of 0.996. This suggest that there is very little agreement between the test statistics and the region pairs that are significant. However, since the Jaccardâ€™s distance is not 1, there is some agreement. In the following, we look at pairs of regions that are signifcantly different from both the volume and FA analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_edge_sig</span> <span class="o">=</span> <span class="n">vol_edge</span><span class="p">[</span><span class="n">vol_edge</span><span class="o">.</span><span class="n">significant</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">fa_edge_sig</span> <span class="o">=</span> <span class="n">fa_edge</span><span class="p">[</span><span class="n">fa_edge</span><span class="o">.</span><span class="n">significant</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

<span class="nb">print</span><span class="p">(</span><span class="n">vol_edge</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">vol_edge_sig</span><span class="p">,</span> <span class="n">fa_edge_sig</span><span class="p">)][[</span><span class="s2">&quot;region1&quot;</span><span class="p">,</span> <span class="s2">&quot;region2&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                 region1                            region2
4323             L-Frontal_Cortex_Area_3  L-Pontine_Reticular_NucleusCaudal
18943                         L-Striatum                L-Tegmental_Nucleus
18993                         L-Striatum        L-Red_Nucleus_Magnocellular
19106                         L-Striatum                    R-Raphe_Nucleus
29768                L-Tegmental_Nucleus             L-Posterior_Commissure
30998  L-Pontine_Reticular_NucleusCaudal          R-Interpeduncular_Nucleus
34821             L-Posterior_Commissure                 R-Medial_Lemniscus
</pre></div>
</div>
</div>
</div>
</section>
<section id="vertex-wise-analysis-of-results">
<h2>Vertex wise analysis of results<a class="headerlink" href="#vertex-wise-analysis-of-results" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_regions_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">vol_regions</span><span class="o">.</span><span class="n">stat</span><span class="p">)</span>
<span class="n">fa_regions_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">fa_regions</span><span class="o">.</span><span class="n">stat</span><span class="p">)</span>

<span class="n">kendalltau</span><span class="p">(</span><span class="n">vol_regions_idx</span><span class="p">,</span> <span class="n">fa_regions_idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SignificanceResult(statistic=-0.007097877916499838, pvalue=0.8469772553058393)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jaccard</span><span class="p">(</span><span class="n">vol_regions</span><span class="o">.</span><span class="n">significant</span><span class="p">,</span> <span class="n">fa_regions</span><span class="o">.</span><span class="n">significant</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8478260869565217
</pre></div>
</div>
</div>
</div>
<p>We get Kendallâ€™s Tau of -0.007 and Jaccard distance of 0.848. This suggest that there is very little agreement between the test statistics and the region pairs that are significant. However, since the Jaccardâ€™s distance is not 1, there is some agreement. In the following, we look at regions that are signifcantly different from both the volume and FA analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_regions_sig</span> <span class="o">=</span> <span class="n">vol_regions</span><span class="p">[</span><span class="n">vol_regions</span><span class="o">.</span><span class="n">significant</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">fa_regions_sig</span> <span class="o">=</span> <span class="n">fa_regions</span><span class="p">[</span><span class="n">fa_regions</span><span class="o">.</span><span class="n">significant</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fa_regions</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">vol_regions_sig</span><span class="p">,</span> <span class="n">fa_regions_sig</span><span class="p">)]</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8                             L-Cingulate_Cortex_Area_32
13                               L-Frontal_Cortex_Area_3
24           L-Primary_Somatosensory_Cortex_Barrel_Field
25       L-Primary_Somatosensory_Cortex_Dysgranular_Zone
28             L-Primary_Somatosensory_Cortex_Jaw_Region
34                               L-Primary_Visual_Cortex
66                 L-Bed_Nucleus_of_the_Stria_Terminalis
68                                 L-Periaquaductal_Grey
83                           L-Red_Nucleus_Parvicellular
87                                L-Precuneiform_Nucleus
98     L-Parvicellular_Reticular_Nucleus_and_Principa...
105                         L-Trigeminal_Sensory_Nucleus
106                                   L-Dorsal_Tegmentum
107                                  L-Tegmental_Nucleus
142                      L-Ventral_Spinocerebellar_Tract
148                           L-Cingulate_Cortex_Area_25
152                    L-Microcellular_Tegmental_Nucleus
157                          L-Red_Nucleus_Magnocellular
161                       L-IntermediateReticularNucleus
168                          R-Cingulate_Cortex_Area_24b
173                           R-Cingulate_Cortex_Area_30
178                        R-Dorsolateral_Orbital_Cortex
189                       R-Primary_Somatosensory_Cortex
193       R-Primary_Somatosensory_Cortex_Hindlimb_Region
197      R-Primary_Somatosensory_Cortex_Upper_Lip_Region
214            R-Posterolateral_Cortical_Amygdaloid_Area
217                                 R-Dorsal_Tenia_Tecta
221                                       R-Presubiculum
225                             R-Preoptic_Telencephalon
226                                R-Subthalamic_Nucleus
229                                           R-Striatum
232                R-Bed_Nucleus_of_the_Stria_Terminalis
240                          R-Medial_Geniculate_Nucleus
242                                       R-Zona_Incerta
246                                R-Superior_Colliculus
256                                  R-Cerebellar_Cortex
264    R-Parvicellular_Reticular_Nucleus_and_Principa...
270                                      R-Raphe_Nucleus
283                                 R-Anterior_Commisure
300                            R-Spinal_Trigeminal_Nerve
307                                   R-Medial_Lemniscus
314                           R-Cingulate_Cortex_Area_25
Name: region, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">vol_regions_sig</span><span class="p">,</span> <span class="n">fa_regions_sig</span><span class="p">)</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>42
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="2023-01-10-nonpar.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">K-sample latent position distribution test</p>
      </div>
    </a>
    <a class="right-next"
       href="2023-05-10-combined.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Investigation of Distances of Brain Volume and FA</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Comparisons of differences in brain regions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-average-differences-between-regions">Visualize the average differences between regions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-abolute-differences-in-genotypes">Visualize the abolute differences in genotypes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#edge-wise-analysis-of-distances">Edge-wise analysis of distances</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-wise-analysis-of-distances">Vertex-wise analysis of distances</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparisons-of-differences-in-fractional-anisotropy">Comparisons of differences in fractional anisotropy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Visualize the average differences between regions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Visualize the abolute differences in genotypes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Edge-wise analysis of distances</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Vertex-wise analysis of distances</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-the-results-from-volume-distances-and-fa-distances">Comparing the results from volume distances and FA distances</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#edge-wise-analysis-of-results">Edge-wise analysis of results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vertex-wise-analysis-of-results">Vertex wise analysis of results</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jaewon Chung, Eric B. Bridgeford
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      Â© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>